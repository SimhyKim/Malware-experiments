#pragma comment(lib, "user32.lib")
#include <windows.h>
#include <stdio.h>



int main() {

STARTUPINFOW si = {0};
PROCESS_INFORMATION pi = {0};   
    if (!CreateProcessW(
        L"C:\\Windows\\System32\\notepad.exe",
        NULL,
        NULL,
        NULL,
        FALSE,
        BELOW_NORMAL_PRIORITY_CLASS,
        NULL,
        NULL,
        &si,
        &pi
    ))
    {
        printf("(-) failed to create process, error: %ld", GetLastError());
        return EXIT_FAILURE;
    }

    printf("(+) process started, pid: %ld\nprocess handler: %p", pi.dwProcessId, pi.hProcess);
    printf("\ntid: %ld\nthread handler: %p\n", pi.dwThreadId,  pi.hThread);
    WaitForSingleObject(pi.hProcess,  INFINITE);
    printf("(+) exiting..");  

    TerminateProcess (pi.hProcess, 0);
    CloseHandle(pi.hThread);
    CloseHandle(pi.hProcess);
    
    return EXIT_SUCCESS;

}