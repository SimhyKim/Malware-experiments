

.data
EXTERN NtOpenProcessSSN:DWORD          
EXTERN  NtOpenProcessSyscall:QWORD
EXTERN NtAllocateVirtualMemorySSN:DWORD
EXTERN NtWaitForSingleObjectSSN:DWORD
EXTERN NtCloseSSN:DWORD
EXTERN NtCreateThreadExSSN:DWORD  
EXTERN NtWriteVirtualMemorySSN:DWORD

.code
NtOpenProcess PROC
		mov r10, rcx
		mov eax, NtOpenProcessSSN               
		jmp qword ptr [NtOpenProcessSyscall]
		ret
NtOpenProcess ENDP

NtAllocateVirtualMemory PROC
		mov r10, rcx
		mov eax, NtAllocateVirtualMemorySSN 
		jmp qword ptr [NtOpenProcessSyscall]
		ret
NtAllocateVirtualMemory ENDP

NtWriteVirtualMemory PROC
		mov r10, rcx
		mov eax, NtWriteVirtualMemorySSN 
		syscall
		ret
NtWriteVirtualMemory ENDP

NtCreateThreadEx PROC
		mov r10, rcx
		mov eax, NtCreateThreadExSSN
		syscall
		ret
NtCreateThreadEx ENDP

NtWaitForSingleObject PROC
		mov r10, rcx
		mov eax, NtWaitForSingleObjectSSN 
		syscall
		ret
NtWaitForSingleObject ENDP

NtClose PROC
		mov r10, rcx
		mov eax, NtCloseSSN 
		syscall
		ret
NtClose ENDP

end